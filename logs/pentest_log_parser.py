import json
import argparse
from datetime import datetime

# Set up argument parsing
parser = argparse.ArgumentParser(description='Format log files into a human-readable format.')
parser.add_argument('log_file', type=str, help='Path to the log file')
args = parser.parse_args()

# Function to convert UNIX timestamp to human-readable format
def format_timestamp(timestamp):
    return datetime.utcfromtimestamp(timestamp).strftime('%Y-%m-%d %H:%M:%S')

# Function to read and parse the log file
def process_log_file(file_path):
    with open(file_path, 'r') as file:
        log = json.load(file)
    
    # Process and print the log in a human-readable format
    for source, messages in log.items():
        print(f"Messages from {source}:")
        for message in sorted(messages, key=lambda x: x[0]):  # Sort messages by timestamp
            timestamp = format_timestamp(message[0])
            content = message[1]
            print(f"[{timestamp}] {content}")
        print("\n")

# Call the function with the path provided via command-line argument
process_log_file(args.log_file)
